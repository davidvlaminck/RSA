from lib.reports.DQReport import DQReport


class Report0047:
    def __init__(self):
        self.report = None

    def init_report(self):
        self.report = DQReport(name='report0047',
                               title='Wanneer een BitumineuzeLaag geometrisch op een Onderbouw ligt, dan zijn deze '
                                     'assets verbonden door een LigtOp relatie van BitumineuzeLaag naar Onderbouw.',
                               spreadsheet_id='1BiRG3GxXF1AjpAoCWW_O7ukg2WeCEvGnhew-_YuclrQ',
                               datasource='PostGIS',
                               persistent_column='D')

        self.report.result_query = """
        -- Bouw een tussentabel cte_provincies om zelf een ruimtelijke index na te bouwen, om ze opzoeking te versnellen.
        WITH cte_provincies AS (
            select naam, wkt, st_geomfromtext(wkt, 31370) as geom from (
            values
        ('Antwerpen_4_11','POLYGON ((136231 191295.27230000123,136231 200000,140000 200000,140000 191295.27230000123,136231 191295.27230000123))'),
        ('Antwerpen_5_11','POLYGON ((137945.50759259952 200000,137945.50759259952 201318.61450000107,140000 201318.61450000107,140000 200000,137945.50759259952 200000))'),
        ('Antwerpen_7_11','POLYGON ((139472.2100000009 227962.1824830711,139472.2100000009 229389.22639535714,140000 229389.22639535714,140000 227962.1824830711,139472.2100000009 227962.1824830711))'),
        ('Antwerpen_3_12','POLYGON ((148131.63059999794 189575.4668999985,148131.63059999794 190000,149541.0741999969 190000,149541.0741999969 189575.4668999985,148131.63059999794 189575.4668999985))'),
        ('Antwerpen_4_12','POLYGON ((140000 190000,140000 200000,150000 200000,150000 190000,140000 190000))'),
        ('Antwerpen_5_12','POLYGON ((140000 200000,140000 210000,150000 210000,150000 200000,140000 200000))'),
        ('Antwerpen_6_12','POLYGON ((144507.12849999964 210000,144507.12849999964 220000,150000 220000,150000 210000,144507.12849999964 210000))'),
        ('Antwerpen_7_12','POLYGON ((140000 220000,140000 229767.3830000013,150000 229767.3830000013,150000 220000,140000 220000))'),
        ('Antwerpen_3_13','POLYGON ((150093.120099999 186754.45980000123,150093.120099999 190000,160000 190000,160000 186754.45980000123,150093.120099999 186754.45980000123))'),
        ('Antwerpen_4_13','POLYGON ((150000 190000,150000 200000,160000 200000,160000 190000,150000 190000))'),
        ('Antwerpen_5_13','POLYGON ((150000 200000,150000 210000,160000 210000,160000 200000,150000 200000))'),
        ('Antwerpen_6_13','POLYGON ((150000 210000,150000 220000,160000 220000,160000 210000,150000 210000))'),
        ('Antwerpen_7_13','POLYGON ((150000 220000,150000 230000,160000 230000,160000 220000,150000 220000))'),
        ('Antwerpen_8_13','POLYGON ((150734.6499999985 230000,150734.6499999985 240000,160000 240000,160000 230000,150734.6499999985 230000))'),
        ('Antwerpen_9_13','POLYGON ((155940.89904032915 240000,155940.89904032915 241154.12328283192,160000 241154.12328283192,160000 240000,155940.89904032915 240000))'),
        ('Antwerpen_3_14','POLYGON ((160000 186678.8995999992,160000 190000,170000 190000,170000 186678.8995999992,160000 186678.8995999992))'),
        ('Antwerpen_4_14','POLYGON ((160000 190000,160000 200000,170000 200000,170000 190000,160000 190000))'),
        ('Antwerpen_5_14','POLYGON ((160000 200000,160000 210000,170000 210000,170000 200000,160000 200000))'),
        ('Antwerpen_6_14','POLYGON ((160000 210000,160000 220000,170000 220000,170000 210000,160000 210000))'),
        ('Antwerpen_7_14','POLYGON ((160000 220000,160000 230000,170000 230000,170000 220000,160000 220000))'),
        ('Antwerpen_8_14','POLYGON ((160000 230000,160000 240000,170000 240000,170000 230000,160000 230000))'),
        ('Antwerpen_9_14','POLYGON ((160000 240000,160000 241436.18499999866,162465.86860000342 241436.18499999866,162465.86860000342 240000,160000 240000))'),
        ('Antwerpen_3_15','POLYGON ((170000 187649.02450000122,170000 190000,175343.69557065732 190000,175343.69557065732 187649.02450000122,170000 187649.02450000122))'),
        ('Antwerpen_4_15','POLYGON ((170000 190000,170000 200000,180000 200000,180000 190000,170000 190000))'),
        ('Antwerpen_5_15','POLYGON ((170000 200000,170000 210000,180000 210000,180000 200000,170000 200000))'),
        ('Antwerpen_6_15','POLYGON ((170000 210000,170000 220000,180000 220000,180000 210000,170000 210000))'),
        ('Antwerpen_7_15','POLYGON ((170000 220000,170000 230000,180000 230000,180000 220000,170000 220000))'),
        ('Antwerpen_8_15','POLYGON ((170000 230000,170000 240000,180000 240000,180000 230000,170000 230000))'),
        ('Antwerpen_9_15','POLYGON ((174125.67400000244 240000,174125.67400000244 244027.2100000009,180000 244027.2100000009,180000 240000,174125.67400000244 240000))'),
        ('Antwerpen_3_16','POLYGON ((180833.1700000018 189014.1339999996,180833.1700000018 190000,184473.08119490588 190000,184473.08119490588 189014.1339999996,180833.1700000018 189014.1339999996))'),
        ('Antwerpen_4_16','POLYGON ((180000 190000,180000 200000,190000 200000,190000 190000,180000 190000))'),
        ('Antwerpen_5_16','POLYGON ((180000 200000,180000 210000,190000 210000,190000 200000,180000 200000))'),
        ('Antwerpen_6_16','POLYGON ((180000 210000,180000 220000,190000 220000,190000 210000,180000 210000))'),
        ('Antwerpen_7_16','POLYGON ((180000 220000,180000 230000,190000 230000,190000 220000,180000 220000))'),
        ('Antwerpen_8_16','POLYGON ((180000 230000,180000 240000,190000 240000,190000 230000,180000 230000))'),
        ('Antwerpen_9_16','POLYGON ((180000 240000,180000 243303.98000000045,182869.75039999932 243303.98000000045,182869.75039999932 240000,180000 240000))'),
        ('Antwerpen_4_17','POLYGON ((190000 191811.62330000103,190000 200000,200000 200000,200000 191811.62330000103,190000 191811.62330000103))'),
        ('Antwerpen_5_17','POLYGON ((190000 200000,190000 210000,200000 210000,200000 200000,190000 200000))'),
        ('Antwerpen_6_17','POLYGON ((190000 210000,190000 220000,200000 220000,200000 210000,190000 210000))'),
        ('Antwerpen_7_17','POLYGON ((190000 220000,190000 230000,200000 230000,200000 220000,190000 220000))'),
        ('Antwerpen_8_17','POLYGON ((190000 230000,190000 240000,200000 240000,200000 230000,190000 230000))'),
        ('Antwerpen_9_17','POLYGON ((194455.21883287642 240000,194455.21883287642 242186.84219999984,199525.5038762165 242186.84219999984,199525.5038762165 240000,194455.21883287642 240000))'),
        ('Antwerpen_4_18','POLYGON ((200000 197250.4497999996,200000 200000,203003.87438076077 200000,203003.87438076077 197250.4497999996,200000 197250.4497999996))'),
        ('Antwerpen_5_18','POLYGON ((200000 200000,200000 210000,210000 210000,210000 200000,200000 200000))'),
        ('Antwerpen_6_18','POLYGON ((200000 210000,200000 220000,210000 220000,210000 210000,200000 210000))'),
        ('Antwerpen_7_18','POLYGON ((200000 220000,200000 230000,210000 230000,210000 220000,200000 220000))'),
        ('Antwerpen_8_18','POLYGON ((200000 230000,200000 238851.03570430938,201177.2899999991 238851.03570430938,201177.2899999991 230000,200000 230000))'),
        ('Antwerpen_5_19','POLYGON ((210000 202865.8900000006,210000 210000,212519.21450000256 210000,212519.21450000256 202865.8900000006,210000 202865.8900000006))'),
        ('Antwerpen_6_19','POLYGON ((210000 210000,210000 220000,211194.33342686758 220000,211194.33342686758 210000,210000 210000))'),
        ('Antwerpen_7_19','POLYGON ((210000 220000,210000 222654.93073231736,210910.6400000006 222654.93073231736,210910.6400000006 220000,210000 220000))'),
        ('Limburg_2_17','POLYGON ((197756.23202768964 178674.07440000027,197756.23202768964 180000,200000 180000,200000 178674.07440000027,197756.23202768964 178674.07440000027))'),
        ('Limburg_3_17','POLYGON ((197281.85710000247 180000,197281.85710000247 190000,200000 190000,200000 180000,197281.85710000247 180000))'),
        ('Limburg_4_17','POLYGON ((192882.16700000316 190000,192882.16700000316 197253.3110197046,200000 197253.3110197046,200000 190000,192882.16700000316 190000))'),
        ('Limburg_0_18','POLYGON ((201718.43909999728 154162.82200000063,201718.43909999728 160000,210000 160000,210000 154162.82200000063,201718.43909999728 154162.82200000063))'),
        ('Limburg_1_18','POLYGON ((201817.76865252157 160000,201817.76865252157 170000,210000 170000,210000 160000,201817.76865252157 160000))'),
        ('Limburg_2_18','POLYGON ((200000 170000,200000 180000,210000 180000,210000 170000,200000 170000))'),
        ('Limburg_3_18','POLYGON ((200000 180000,200000 190000,210000 190000,210000 180000,200000 180000))'),
        ('Limburg_4_18','POLYGON ((200000 190000,200000 200000,210000 200000,210000 190000,200000 190000))'),
        ('Limburg_5_18','POLYGON ((203003.87438076077 200000,203003.87438076077 203729.7324000001,210000 203729.7324000001,210000 200000,203003.87438076077 200000))'),
        ('Limburg_6_18','POLYGON ((209096.05600000173 210947.02855694215,209096.05600000173 216493.74646412616,210000 216493.74646412616,210000 210947.02855694215,209096.05600000173 210947.02855694215))'),
        ('Limburg_0_19','POLYGON ((210000 156435.500500001,210000 160000,219271.42857261645 160000,219271.42857261645 156435.500500001,210000 156435.500500001))'),
        ('Limburg_1_19','POLYGON ((210000 160000,210000 170000,220000 170000,220000 160000,210000 160000))'),
        ('Limburg_2_19','POLYGON ((210000 170000,210000 180000,220000 180000,220000 170000,210000 170000))'),
        ('Limburg_3_19','POLYGON ((210000 180000,210000 190000,220000 190000,220000 180000,210000 180000))'),
        ('Limburg_4_19','POLYGON ((210000 190000,210000 200000,220000 200000,220000 190000,210000 190000))'),
        ('Limburg_5_19','POLYGON ((210000 200000,210000 210000,220000 210000,220000 200000,210000 200000))'),
        ('Limburg_6_19','POLYGON ((210000 210000,210000 218881.69999999925,220000 218881.69999999925,220000 210000,210000 210000))'),
        ('Limburg_0_20','POLYGON ((220779.70640980382 156933,220779.70640980382 160000,230000 160000,230000 156933,220779.70640980382 156933))'),
        ('Limburg_1_20','POLYGON ((220000 160000,220000 170000,230000 170000,230000 160000,220000 160000))'),
        ('Limburg_2_20','POLYGON ((220000 170000,220000 180000,230000 180000,230000 170000,220000 170000))'),
        ('Limburg_3_20','POLYGON ((220000 180000,220000 190000,230000 190000,230000 180000,220000 180000))'),
        ('Limburg_4_20','POLYGON ((220000 190000,220000 200000,230000 200000,230000 190000,220000 190000))'),
        ('Limburg_5_20','POLYGON ((220000 200000,220000 210000,230000 210000,230000 200000,220000 200000))'),
        ('Limburg_6_20','POLYGON ((220000 210000,220000 220000,230000 220000,230000 210000,220000 210000))'),
        ('Limburg_7_20','POLYGON ((226486.7106201609 220000,226486.7106201609 221730.44999999925,230000 221730.44999999925,230000 220000,226486.7106201609 220000))'),
        ('Limburg_0_21','POLYGON ((230000 158737.5296811831,230000 160000,231573.04609999806 160000,231573.04609999806 158737.5296811831,230000 158737.5296811831))'),
        ('Limburg_1_21','POLYGON ((230000 160000,230000 170000,240000 170000,240000 160000,230000 160000))'),
        ('Limburg_2_21','POLYGON ((230000 170000,230000 180000,240000 180000,240000 170000,230000 170000))'),
        ('Limburg_3_21','POLYGON ((230000 180000,230000 190000,240000 190000,240000 180000,230000 180000))'),
        ('Limburg_4_21','POLYGON ((230000 190000,230000 200000,240000 200000,240000 190000,230000 190000))'),
        ('Limburg_5_21','POLYGON ((230000 200000,230000 210000,240000 210000,240000 200000,230000 200000))'),
        ('Limburg_6_21','POLYGON ((230000 210000,230000 220000,239846.0700000003 220000,239846.0700000003 210000,230000 210000))'),
        ('Limburg_7_21','POLYGON ((230000 220000,230000 221213.5801358427,230711.18606972037 221213.5801358427,230711.18606972037 220000,230000 220000))'),
        ('Limburg_1_22','POLYGON ((240000 160319.69779999927,240000 170000,250000 170000,250000 160319.69779999927,240000 160319.69779999927))'),
        ('Limburg_2_22','POLYGON ((240000 170000,240000 180000,245527.75 180000,245527.75 170000,240000 170000))'),
        ('Limburg_3_22','POLYGON ((240000 180000,240000 190000,248191.22999999672 190000,248191.22999999672 180000,240000 180000))'),
        ('Limburg_4_22','POLYGON ((240000 190000,240000 200000,250000 200000,250000 190000,240000 190000))'),
        ('Limburg_5_22','POLYGON ((240000 200000,240000 209727.91000000015,250000 209727.91000000015,250000 200000,240000 200000))'),
        ('Limburg_0_23','POLYGON ((250403.60573486163 156570.25600000098,250403.60573486163 160000,258871.83929999918 160000,258871.83929999918 156570.25600000098,250403.60573486163 156570.25600000098))'),
        ('Limburg_1_23','POLYGON ((250000 160000,250000 163280.2100000009,258550.3900344569 163280.2100000009,258550.3900344569 160000,250000 160000))'),
        ('Limburg_4_23','POLYGON ((250000 195249.41435371424,250000 200000,252613.5700000003 200000,252613.5700000003 195249.41435371424,250000 195249.41435371424))'),
        ('Limburg_5_23','POLYGON ((250000 200000,250000 207422.94999999925,254053.77000000328 207422.94999999925,254053.77000000328 200000,250000 200000))'),
        ('Oost-Vlaanderen_4_5','POLYGON ((77334.77849999815 197663.3462267084,77334.77849999815 200000,80000 200000,80000 197663.3462267084,77334.77849999815 197663.3462267084))'),
        ('Oost-Vlaanderen_5_5','POLYGON ((78421.63549999893 200000,78421.63549999893 210000,80000 210000,80000 200000,78421.63549999893 200000))'),
        ('Oost-Vlaanderen_6_5','POLYGON ((79822.91160000116 210000,79822.91160000116 210121.7657982506,80000 210121.7657982506,80000 210000,79822.91160000116 210000))'),
        ('Oost-Vlaanderen_1_6','POLYGON ((85823.5700000003 161145.308699999,85823.5700000003 170000,90000 170000,90000 161145.308699999,85823.5700000003 161145.308699999))'),
        ('Oost-Vlaanderen_2_6','POLYGON ((82938.65789999813 170000,82938.65789999813 180000,90000 180000,90000 170000,82938.65789999813 170000))'),
        ('Oost-Vlaanderen_3_6','POLYGON ((82880.29100000113 180000,82880.29100000113 190000,90000 190000,90000 180000,82880.29100000113 180000))'),
        ('Oost-Vlaanderen_4_6','POLYGON ((80000 190000,80000 200000,90000 200000,90000 190000,80000 190000))'),
        ('Oost-Vlaanderen_5_6','POLYGON ((80000 200000,80000 210000,90000 210000,90000 200000,80000 200000))'),
        ('Oost-Vlaanderen_6_6','POLYGON ((80000 210000,80000 218742.69999999925,90000 218742.69999999925,90000 210000,80000 210000))'),
        ('Oost-Vlaanderen_0_7','POLYGON ((91529.62810000032 156976.6777999997,91529.62810000032 160000,99908.13899999857 160000,99908.13899999857 156976.6777999997,91529.62810000032 156976.6777999997))'),
        ('Oost-Vlaanderen_1_7','POLYGON ((90000 160000,90000 170000,100000 170000,100000 160000,90000 160000))'),
        ('Oost-Vlaanderen_2_7','POLYGON ((90000 170000,90000 180000,100000 180000,100000 170000,90000 170000))'),
        ('Oost-Vlaanderen_3_7','POLYGON ((90000 180000,90000 190000,100000 190000,100000 180000,90000 180000))'),
        ('Oost-Vlaanderen_4_7','POLYGON ((90000 190000,90000 200000,100000 200000,100000 190000,90000 190000))'),
        ('Oost-Vlaanderen_5_7','POLYGON ((90000 200000,90000 210000,100000 210000,100000 200000,90000 200000))'),
        ('Oost-Vlaanderen_6_7','POLYGON ((90000 210000,90000 220000,100000 220000,100000 210000,90000 210000))'),
        ('Oost-Vlaanderen_7_7','POLYGON ((90467.1799999997 220000,90467.1799999997 222075.19999999925,100000 222075.19999999925,100000 220000,90467.1799999997 220000))'),
        ('Oost-Vlaanderen_0_8','POLYGON ((108075.9230943133 159828.79899999872,108075.9230943133 160000,109451.49305541116 160000,109451.49305541116 159828.79899999872,108075.9230943133 159828.79899999872))'),
        ('Oost-Vlaanderen_1_8','POLYGON ((100000 160000,100000 170000,110000 170000,110000 160000,100000 160000))'),
        ('Oost-Vlaanderen_2_8','POLYGON ((100000 170000,100000 180000,110000 180000,110000 170000,100000 170000))'),
        ('Oost-Vlaanderen_3_8','POLYGON ((100000 180000,100000 190000,110000 190000,110000 180000,100000 180000))'),
        ('Oost-Vlaanderen_4_8','POLYGON ((100000 190000,100000 200000,110000 200000,110000 190000,100000 190000))'),
        ('Oost-Vlaanderen_5_8','POLYGON ((100000 200000,100000 210000,110000 210000,110000 200000,100000 200000))'),
        ('Oost-Vlaanderen_6_8','POLYGON ((100000 210000,100000 220000,110000 220000,110000 210000,100000 210000))'),
        ('Oost-Vlaanderen_7_8','POLYGON ((100000 220000,100000 220290.0700000003,100872.94734635914 220290.0700000003,100872.94734635914 220000,100000 220000))'),
        ('Oost-Vlaanderen_0_9','POLYGON ((111019.1059891858 157538.16820000112,111019.1059891858 160000,120000 160000,120000 157538.16820000112,111019.1059891858 157538.16820000112))'),
        ('Oost-Vlaanderen_1_9','POLYGON ((110000 160000,110000 170000,120000 170000,120000 160000,110000 160000))'),
        ('Oost-Vlaanderen_2_9','POLYGON ((110000 170000,110000 180000,120000 180000,120000 170000,110000 170000))'),
        ('Oost-Vlaanderen_3_9','POLYGON ((110000 180000,110000 190000,120000 190000,120000 180000,110000 180000))'),
        ('Oost-Vlaanderen_4_9','POLYGON ((110000 190000,110000 200000,120000 200000,120000 190000,110000 190000))'),
        ('Oost-Vlaanderen_5_9','POLYGON ((110000 200000,110000 210000,120000 210000,120000 200000,110000 200000))'),
        ('Oost-Vlaanderen_6_9','POLYGON ((110000 210000,110000 212672.19999999925,120000 212672.19999999925,120000 210000,110000 210000))'),
        ('Oost-Vlaanderen_0_10','POLYGON ((120000 157699.8878000006,120000 160000,120737.71500000358 160000,120737.71500000358 157699.8878000006,120000 157699.8878000006))'),
        ('Oost-Vlaanderen_1_10','POLYGON ((120000 160000,120000 170000,129333.60339999944 170000,129333.60339999944 160000,120000 160000))'),
        ('Oost-Vlaanderen_2_10','POLYGON ((120000 170000,120000 180000,130000 180000,130000 170000,120000 170000))'),
        ('Oost-Vlaanderen_3_10','POLYGON ((120000 180000,120000 190000,130000 190000,130000 180000,120000 180000))'),
        ('Oost-Vlaanderen_4_10','POLYGON ((120000 190000,120000 200000,130000 200000,130000 190000,120000 190000))'),
        ('Oost-Vlaanderen_5_10','POLYGON ((120000 200000,120000 210000,130000 210000,130000 200000,120000 200000))'),
        ('Oost-Vlaanderen_6_10','POLYGON ((120000 210000,120000 216188.096414512,130000 216188.096414512,130000 210000,120000 210000))'),
        ('Oost-Vlaanderen_2_11','POLYGON ((130000 173988.68118606292,130000 180000,135274.68967750968 180000,135274.68967750968 173988.68118606292,130000 173988.68118606292))'),
        ('Oost-Vlaanderen_3_11','POLYGON ((130000 180000,130000 190000,140000 190000,140000 180000,130000 180000))'),
        ('Oost-Vlaanderen_4_11','POLYGON ((130000 190000,130000 200000,140000 200000,140000 190000,130000 190000))'),
        ('Oost-Vlaanderen_5_11','POLYGON ((130000 200000,130000 210000,140000 210000,140000 200000,130000 200000))'),
        ('Oost-Vlaanderen_6_11','POLYGON ((130000 210000,130000 220000,140000 220000,140000 210000,130000 210000))'),
        ('Oost-Vlaanderen_7_11','POLYGON ((135336.58599907887 220000,135336.58599907887 225641.75345905908,140000 225641.75345905908,140000 220000,135336.58599907887 220000))'),
        ('Oost-Vlaanderen_3_12','POLYGON ((140000 187314.438000001,140000 190000,140841.14528442468 190000,140841.14528442468 187314.438000001,140000 187314.438000001))'),
        ('Oost-Vlaanderen_4_12','POLYGON ((140000 190000,140000 192575.51060000062,141045.67170000076 192575.51060000062,141045.67170000076 190000,140000 190000))'),
        ('Oost-Vlaanderen_5_12','POLYGON ((140000 200564,140000 210000,147306.5319999978 210000,147306.5319999978 200564,140000 200564))'),
        ('Oost-Vlaanderen_6_12','POLYGON ((140000 210000,140000 220000,146563.29649999738 220000,146563.29649999738 210000,140000 210000))'),
        ('Oost-Vlaanderen_7_12','POLYGON ((140000 220000,140000 227140.44999999925,146189.2492232543 227140.44999999925,146189.2492232543 220000,140000 220000))'),
        ('Vlaams Brabant_0_9','POLYGON ((116098.22519999743 153277.9299999997,116098.22519999743 160000,120000 160000,120000 153277.9299999997,116098.22519999743 153277.9299999997))'),
        ('Vlaams Brabant_1_9','POLYGON ((119114.25140000135 160000,119114.25140000135 162640.74916329066,120000 162640.74916329066,120000 160000,119114.25140000135 160000))'),
        ('Vlaams Brabant_0_10','POLYGON ((120000 153058.3299999982,120000 160000,130000 160000,130000 153058.3299999982,120000 153058.3299999982))'),
        ('Vlaams Brabant_1_10','POLYGON ((120000 160000,120000 170000,130000 170000,130000 160000,120000 160000))'),
        ('Vlaams Brabant_2_10','POLYGON ((127233.21940018165 170000,127233.21940018165 176924.9978,130000 176924.9978,130000 170000,127233.21940018165 170000))'),
        ('Vlaams Brabant_0_11','POLYGON ((130000 154337.1937513915,130000 160000,140000 160000,140000 154337.1937513915,130000 154337.1937513915))'),
        ('Vlaams Brabant_1_11','POLYGON ((130000 160000,130000 170000,140000 170000,140000 160000,130000 160000))'),
        ('Vlaams Brabant_2_11','POLYGON ((130000 170000,130000 180000,140000 180000,140000 170000,130000 170000))'),
        ('Vlaams Brabant_3_11','POLYGON ((130720.81034700798 180000,130720.81034700798 189576.71135043283,140000 189576.71135043283,140000 180000,130720.81034700798 180000))'),
        ('Vlaams Brabant_0_12','POLYGON ((140000 153222.04960000142,140000 160000,150000 160000,150000 153222.04960000142,140000 153222.04960000142))'),
        ('Vlaams Brabant_1_12','POLYGON ((140000 160000,140000 170000,150000 170000,150000 160000,140000 160000))'),
        ('Vlaams Brabant_2_12','POLYGON ((140000 170000,140000 180000,150000 180000,150000 170000,140000 170000))'),
        ('Vlaams Brabant_3_12','POLYGON ((140000 180000,140000 190000,150000 190000,150000 180000,140000 180000))'),
        ('Vlaams Brabant_4_12','POLYGON ((140829.27560000122 190000,140829.27560000122 192563.02389999852,150000 192563.02389999852,150000 190000,140829.27560000122 190000))'),
        ('Vlaams Brabant_0_13','POLYGON ((150000 156184.91070000082,150000 160000,160000 160000,160000 156184.91070000082,150000 156184.91070000082))'),
        ('Vlaams Brabant_1_13','POLYGON ((150000 160000,150000 170000,160000 170000,160000 160000,150000 160000))'),
        ('Vlaams Brabant_2_13','POLYGON ((150000 170000,150000 180000,160000 180000,160000 170000,150000 170000))'),
        ('Vlaams Brabant_3_13','POLYGON ((150000 180000,150000 190000,160000 190000,160000 180000,150000 180000))'),
        ('Vlaams Brabant_4_13','POLYGON ((150000 190000,150000 191191.24599999934,150907.8748999983 191191.24599999934,150907.8748999983 190000,150000 190000))'),
        ('Vlaams Brabant_0_14','POLYGON ((160000 157432.6400000006,160000 160000,169622.83730000257 160000,169622.83730000257 157432.6400000006,160000 157432.6400000006))'),
        ('Vlaams Brabant_1_14','POLYGON ((160000 160000,160000 170000,170000 170000,170000 160000,160000 160000))'),
        ('Vlaams Brabant_2_14','POLYGON ((160000 170000,160000 180000,170000 180000,170000 170000,160000 170000))'),
        ('Vlaams Brabant_3_14','POLYGON ((160000 180000,160000 189990.11930000037,170000 189990.11930000037,170000 180000,160000 180000))'),
        ('Vlaams Brabant_1_15','POLYGON ((170000 160244.50292606247,170000 170000,180000 170000,180000 160244.50292606247,170000 160244.50292606247))'),
        ('Vlaams Brabant_2_15','POLYGON ((170000 170000,170000 180000,180000 180000,180000 170000,170000 170000))'),
        ('Vlaams Brabant_3_15','POLYGON ((170000 180000,170000 190000,180000 190000,180000 180000,170000 180000))'),
        ('Vlaams Brabant_4_15','POLYGON ((170985.83033620016 190000,170985.83033620016 192169.94849999994,180000 192169.94849999994,180000 190000,170985.83033620016 190000))'),
        ('Vlaams Brabant_0_16','POLYGON ((188607.485487085 159277.56500000134,188607.485487085 160000,190000 160000,190000 159277.56500000134,188607.485487085 159277.56500000134))'),
        ('Vlaams Brabant_1_16','POLYGON ((180000 160000,180000 170000,190000 170000,190000 160000,180000 160000))'),
        ('Vlaams Brabant_2_16','POLYGON ((180000 170000,180000 180000,190000 180000,190000 170000,180000 170000))'),
        ('Vlaams Brabant_3_16','POLYGON ((180000 180000,180000 190000,190000 190000,190000 180000,180000 180000))'),
        ('Vlaams Brabant_4_16','POLYGON ((180000 190000,180000 192074.14779999852,190000 192074.14779999852,190000 190000,180000 190000))'),
        ('Vlaams Brabant_0_17','POLYGON ((190000 155335.29679999873,190000 160000,200000 160000,200000 155335.29679999873,190000 155335.29679999873))'),
        ('Vlaams Brabant_1_17','POLYGON ((190000 160000,190000 170000,200000 170000,200000 160000,190000 160000))'),
        ('Vlaams Brabant_2_17','POLYGON ((190000 170000,190000 180000,200000 180000,200000 170000,190000 170000))'),
        ('Vlaams Brabant_3_17','POLYGON ((190000 180000,190000 190000,200000 190000,200000 180000,190000 180000))'),
        ('Vlaams Brabant_4_17','POLYGON ((190000 190000,190000 193367.32139493714,200000 193367.32139493714,200000 190000,190000 190000))'),
        ('Vlaams Brabant_0_18','POLYGON ((200000 155004.9989,200000 160000,203133.75360000134 160000,203133.75360000134 155004.9989,200000 155004.9989))'),
        ('Vlaams Brabant_1_18','POLYGON ((200000 160000,200000 170000,205228.08370000124 170000,205228.08370000124 160000,200000 160000))'),
        ('Vlaams Brabant_2_18','POLYGON ((200000 170000,200000 179301.59970000014,207629.6595999971 179301.59970000014,207629.6595999971 170000,200000 170000))'),
        ('Vlaams Brabant_3_18','POLYGON ((200000 184115.36823859427,200000 190000,204184.17168864002 190000,204184.17168864002 184115.36823859427,200000 184115.36823859427))'),
        ('Vlaams Brabant_4_18','POLYGON ((200000 190000,200000 193541.1895999983,205492.92660000175 193541.1895999983,205492.92660000175 190000,200000 190000))'),
        ('West-Vlaanderen_1_0','POLYGON ((27330.080879996265 168366.07239999995,27330.080879996265 170000,30000 170000,30000 168366.07239999995,27330.080879996265 168366.07239999995))'),
        ('West-Vlaanderen_2_0','POLYGON ((25022.412766910486 170000,25022.412766910486 180000,30000 180000,30000 170000,25022.412766910486 170000))'),
        ('West-Vlaanderen_3_0','POLYGON ((24038.65039999783 180000,24038.65039999783 190000,30000 190000,30000 180000,24038.65039999783 180000))'),
        ('West-Vlaanderen_4_0','POLYGON ((21991.632100000978 190000,21991.632100000978 200000,30000 200000,30000 190000,21991.632100000978 190000))'),
        ('West-Vlaanderen_5_0','POLYGON ((22526.066904493367 200000,22526.066904493367 204293.2059503576,30000 204293.2059503576,30000 200000,22526.066904493367 200000))'),
        ('West-Vlaanderen_0_1','POLYGON ((38113.72930921755 157475.51590000093,38113.72930921755 160000,40000 160000,40000 157475.51590000093,38113.72930921755 157475.51590000093))'),
        ('West-Vlaanderen_1_1','POLYGON ((30000 160000,30000 170000,40000 170000,40000 160000,30000 160000))'),
        ('West-Vlaanderen_2_1','POLYGON ((30000 170000,30000 180000,40000 180000,40000 170000,30000 170000))'),
        ('West-Vlaanderen_3_1','POLYGON ((30000 180000,30000 190000,40000 190000,40000 180000,30000 180000))'),
        ('West-Vlaanderen_4_1','POLYGON ((30000 190000,30000 200000,40000 200000,40000 190000,30000 190000))'),
        ('West-Vlaanderen_5_1','POLYGON ((30000 200000,30000 209440.869033173,40000 209440.869033173,40000 200000,30000 200000))'),
        ('West-Vlaanderen_0_2','POLYGON ((40000 156379.51559999958,40000 160000,44129.428999997675 160000,44129.428999997675 156379.51559999958,40000 156379.51559999958))'),
        ('West-Vlaanderen_1_2','POLYGON ((40000 160000,40000 170000,50000 170000,50000 160000,40000 160000))'),
        ('West-Vlaanderen_2_2','POLYGON ((40000 170000,40000 180000,50000 180000,50000 170000,40000 170000))'),
        ('West-Vlaanderen_3_2','POLYGON ((40000 180000,40000 190000,50000 190000,50000 180000,40000 180000))'),
        ('West-Vlaanderen_4_2','POLYGON ((40000 190000,40000 200000,50000 200000,50000 190000,40000 190000))'),
        ('West-Vlaanderen_5_2','POLYGON ((40000 200000,40000 210000,50000 210000,50000 200000,40000 200000))'),
        ('West-Vlaanderen_6_2','POLYGON ((40887.04109336182 210000,40887.04109336182 215931.32558691938,50000 215931.32558691938,50000 210000,40887.04109336182 210000))'),
        ('West-Vlaanderen_1_3','POLYGON ((50000 162991.2899999991,50000 170000,60000 170000,60000 162991.2899999991,50000 162991.2899999991))'),
        ('West-Vlaanderen_2_3','POLYGON ((50000 170000,50000 180000,60000 180000,60000 170000,50000 170000))'),
        ('West-Vlaanderen_3_3','POLYGON ((50000 180000,50000 190000,60000 190000,60000 180000,50000 180000))'),
        ('West-Vlaanderen_4_3','POLYGON ((50000 190000,50000 200000,60000 200000,60000 190000,50000 190000))'),
        ('West-Vlaanderen_5_3','POLYGON ((50000 200000,50000 210000,60000 210000,60000 200000,50000 200000))'),
        ('West-Vlaanderen_6_3','POLYGON ((50000 210000,50000 220000,60000 220000,60000 210000,50000 210000))'),
        ('West-Vlaanderen_7_3','POLYGON ((56452.95551633603 220000,56452.95551633603 222493.64086381075,60000 222493.64086381075,60000 220000,56452.95551633603 220000))'),
        ('West-Vlaanderen_1_4','POLYGON ((60000 161203.75239999965,60000 170000,70000 170000,70000 161203.75239999965,60000 161203.75239999965))'),
        ('West-Vlaanderen_2_4','POLYGON ((60000 170000,60000 180000,70000 180000,70000 170000,60000 170000))'),
        ('West-Vlaanderen_3_4','POLYGON ((60000 180000,60000 190000,70000 190000,70000 180000,60000 180000))'),
        ('West-Vlaanderen_4_4','POLYGON ((60000 190000,60000 200000,70000 200000,70000 190000,60000 190000))'),
        ('West-Vlaanderen_5_4','POLYGON ((60000 200000,60000 210000,70000 210000,70000 200000,60000 200000))'),
        ('West-Vlaanderen_6_4','POLYGON ((60000 210000,60000 220000,70000 220000,70000 210000,60000 210000))'),
        ('West-Vlaanderen_7_4','POLYGON ((60000 220000,60000 228822.62269999832,70000 228822.62269999832,70000 220000,60000 220000))'),
        ('West-Vlaanderen_0_5','POLYGON ((75645.25348525384 155928.62249999866,75645.25348525384 160000,80000 160000,80000 155928.62249999866,75645.25348525384 155928.62249999866))'),
        ('West-Vlaanderen_1_5','POLYGON ((70000 160000,70000 170000,80000 170000,80000 160000,70000 160000))'),
        ('West-Vlaanderen_2_5','POLYGON ((70000 170000,70000 180000,80000 180000,80000 170000,70000 170000))'),
        ('West-Vlaanderen_3_5','POLYGON ((70000 180000,70000 190000,80000 190000,80000 180000,70000 180000))'),
        ('West-Vlaanderen_4_5','POLYGON ((70000 190000,70000 200000,80000 200000,80000 190000,70000 190000))'),
        ('West-Vlaanderen_5_5','POLYGON ((70000 200000,70000 210000,80000 210000,80000 200000,70000 200000))'),
        ('West-Vlaanderen_6_5','POLYGON ((70000 210000,70000 220000,80000 220000,80000 210000,70000 210000))'),
        ('West-Vlaanderen_7_5','POLYGON ((70000 220000,70000 229724.56639999896,80000 229724.56639999896,80000 220000,70000 220000))'),
        ('West-Vlaanderen_0_6','POLYGON ((80000 157948.8139999993,80000 160000,83501.82158139223 160000,83501.82158139223 157948.8139999993,80000 157948.8139999993))'),
        ('West-Vlaanderen_1_6','POLYGON ((80000 160000,80000 170000,90000 170000,90000 160000,80000 160000))'),
        ('West-Vlaanderen_2_6','POLYGON ((80000 170000,80000 180000,89054.80449999869 180000,89054.80449999869 170000,80000 170000))'),
        ('West-Vlaanderen_3_6','POLYGON ((80000 180000,80000 190000,86235.97950000316 190000,86235.97950000316 180000,80000 180000))'),
        ('West-Vlaanderen_4_6','POLYGON ((80000 190000,80000 197663.3462267084,85294.7479000017 197663.3462267084,85294.7479000017 190000,80000 190000))'),
        ('West-Vlaanderen_5_6','POLYGON ((80000 201007.56952619393,80000 209415.13949999958,82999.39630000293 209415.13949999958,82999.39630000293 201007.56952619393,80000 201007.56952619393))'),
        ('West-Vlaanderen_6_6','POLYGON ((80000 210121.21269999817,80000 220000,82293.22789999843 220000,82293.22789999843 210121.21269999817,80000 210121.21269999817))'),
        ('West-Vlaanderen_7_6','POLYGON ((80000 220000,80000 229666.22175730634,81462.39999999851 229666.22175730634,81462.39999999851 220000,80000 220000))'),
        ('West-Vlaanderen_1_7','POLYGON ((90000 165498.5992657333,90000 166855.93227921907,90410.78450000286 166855.93227921907,90410.78450000286 165498.5992657333,90000 165498.5992657333))')
            ) as v(naam, wkt)
        )
        , cte_a_bl_ob as (
            SELECT a.uuid, a_t.uri, ST_GeomFromText(wkt_string, 31370) AS geom
            FROM assets a
                INNER JOIN assettypes a_t ON a.assettype = a_t.uuid
                INNER JOIN geometrie g ON g.assetuuid = a.uuid
            WHERE a_t.uri in ('https://wegenenverkeer.data.vlaanderen.be/ns/onderdeel#BitumineuzeLaag', 'https://wegenenverkeer.data.vlaanderen.be/ns/onderdeel#Onderbouw')
              AND a.actief = TRUE
        )
        , cte_a_bl as (
            SELECT a.uuid, a.geom, prv.naam as prv_naam, prv.geom as prv_geom
            FROM cte_a_bl_ob a
                inner join cte_provincies prv on st_intersects(a.geom, prv.geom)
            WHERE a.uri = 'https://wegenenverkeer.data.vlaanderen.be/ns/onderdeel#BitumineuzeLaag'
            order by prv.naam asc
            )
        , cte_a_ob AS (
            SELECT a.uuid, a.geom, prv.naam as prv_naam, prv.geom as prv_geom
            FROM cte_a_bl_ob a
                inner join cte_provincies prv on st_intersects(a.geom, prv.geom)
            WHERE a.uri = 'https://wegenenverkeer.data.vlaanderen.be/ns/onderdeel#Onderbouw'
            order by prv.naam asc
            )
        select distinct
            a_bl.uuid AS uuid_bitumineuze_laag
            , a_ob.uuid AS uuid_onderbouw
        from cte_a_bl a_bl
          inner join cte_a_ob a_ob on a_bl.prv_naam = a_ob.prv_naam and st_intersects(a_bl.geom, a_ob.geom)
          -- Voeg de assetrelatie toe, enkel als het relatieType "LigtOp" is, de bron "BitumineuzeLaag" en het doel "Onderbouw".
          LEFT JOIN assetrelaties ON (bronuuid = a_bl.uuid AND doeluuid = a_ob.uuid AND assetrelaties.relatietype = '321c18b8-92ca-4188-a28a-f00cdfaa0e31' AND assetrelaties.actief = TRUE) -- LigtOp
        WHERE assetrelaties.doeluuid IS NULL;
        """

    def run_report(self, sender):
        self.report.run_report(sender=sender)
